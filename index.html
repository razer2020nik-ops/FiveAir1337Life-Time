<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FiveAir1337Life-Time</title>
  <meta name="description" content="–†–µ–∞–ª—å–Ω–∞—è –∂–∏–∑–Ω—å –±–µ–∑ –≤–æ–¥—ã: —Ä–∞–±–æ—Ç–∞, –¥–µ–Ω—å–≥–∏, –Ω–∞–≤—ã–∫–∏ –∏ –±–∏–∑–Ω–µ—Å." />

  <style>
    :root{
      --bg:#0b0f14;
      --panel:#101823;
      --panel2:#0f1620;
      --text:#e7eef7;
      --muted:#9db0c7;
      --line:#223042;
      --accent:#2d7cff;
      --accent2:#7aa9ff;
      --good:#43d17a;
      --bad:#ff5c5c;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:radial-gradient(1200px 600px at 15% 0%, rgba(45,124,255,.20), transparent 60%),
                 radial-gradient(900px 500px at 90% 20%, rgba(122,169,255,.12), transparent 55%),
                 var(--bg);
      color:var(--text);
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1100px;margin:0 auto;padding:18px}
    .topbar{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: rgba(11,15,20,.70);
      border-bottom:1px solid rgba(34,48,66,.65);
    }
    .topbar-inner{
      max-width:1100px;margin:0 auto;padding:14px 18px;
      display:flex;align-items:center;justify-content:space-between;gap:14px;
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{
      width:36px;height:36px;border-radius:12px;
      background:linear-gradient(135deg, rgba(45,124,255,.95), rgba(122,169,255,.55));
      box-shadow: var(--shadow);
      display:grid;place-items:center;
      font-weight:900;letter-spacing:.5px;color:#06101d;
    }
    .brand h1{font-size:16px;margin:0}
    .brand span{display:block;font-size:12px;color:var(--muted);margin-top:2px}

    nav{display:flex;gap:10px;flex-wrap:wrap}
    .navbtn{
      padding:10px 12px;border:1px solid rgba(34,48,66,.9);
      background:rgba(16,24,35,.55);
      border-radius:12px;
      font-size:13px;color:var(--muted);
      transition:.2s;
    }
    .navbtn:hover{border-color:rgba(45,124,255,.9);color:var(--text);transform:translateY(-1px)}

    .hero{padding:26px 0 8px}
    .hero-grid{
      display:grid;gap:14px;
      grid-template-columns: 1.35fr .65fr;
    }
    @media (max-width: 900px){
      .hero-grid{grid-template-columns:1fr}
    }
    .card{
      background:linear-gradient(180deg, rgba(16,24,35,.88), rgba(15,22,32,.88));
      border:1px solid rgba(34,48,66,.85);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:16px;
    }
    .hero-title{
      font-size:34px;line-height:1.08;margin:0 0 10px;
      letter-spacing:.2px;
    }
    .hero-sub{margin:0;color:var(--muted);line-height:1.6;max-width:62ch}
    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:14px}
    .chip{
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(34,48,66,.9);
      background:rgba(11,15,20,.35);
      color:var(--muted);
    }
    .chip b{color:var(--text)}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{
      border:none;border-radius:14px;
      padding:12px 14px;
      font-weight:700;
      cursor:pointer;
      transition:.18s;
      display:inline-flex;align-items:center;gap:8px;
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
    }
    .btn-primary{background:var(--accent);color:#08121f}
    .btn-primary:hover{transform:translateY(-1px);filter:brightness(1.05)}
    .btn-ghost{
      background:rgba(11,15,20,.25);
      color:var(--text);
      border:1px solid rgba(34,48,66,.9);
      box-shadow:none;
    }
    .btn-ghost:hover{border-color:rgba(45,124,255,.9);transform:translateY(-1px)}

    .grid{
      display:grid;gap:14px;
      grid-template-columns: 1fr 1fr;
      margin-top:14px;
    }
    @media (max-width: 900px){ .grid{grid-template-columns:1fr} }

    .section-title{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      margin:0 0 10px;
      font-size:18px;
    }
    .muted{color:var(--muted);font-size:13px;line-height:1.55}

    .input, textarea{
      width:100%;
      background:rgba(11,15,20,.35);
      border:1px solid rgba(34,48,66,.9);
      border-radius:14px;
      padding:12px 12px;
      color:var(--text);
      outline:none;
    }
    textarea{min-height:92px;resize:vertical}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row > *{flex:1 1 160px}

    .list{
      display:grid;gap:10px;margin:0;padding:0;list-style:none;
    }
    .item{
      display:flex;gap:10px;align-items:flex-start;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(34,48,66,.85);
      background:rgba(11,15,20,.28);
    }
    .item b{display:block;margin-bottom:4px}
    .tag{
      font-size:12px;color:var(--muted);
      border:1px solid rgba(34,48,66,.85);
      padding:4px 8px;border-radius:999px;
      display:inline-flex;align-items:center;gap:6px;
    }
    .tag .dot{
      width:8px;height:8px;border-radius:50%;
      background:var(--accent2);
      box-shadow:0 0 0 4px rgba(122,169,255,.12);
    }
    .kpi{
      display:flex;gap:10px;flex-wrap:wrap;margin-top:10px
    }
    .kpi .box{
      flex:1 1 140px;
      background:rgba(11,15,20,.25);
      border:1px solid rgba(34,48,66,.85);
      border-radius:14px;
      padding:12px;
    }
    .kpi .box .n{font-size:20px;font-weight:900;margin-top:4px}
    .small{font-size:12px;color:var(--muted)}
    footer{
      padding:26px 0 34px;
      color:var(--muted);
      text-align:center;
      font-size:13px;
    }
    .sep{height:1px;background:rgba(34,48,66,.7);margin:14px 0}
    .ok{color:var(--good);font-weight:800}
    .err{color:var(--bad);font-weight:800}
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo">5A</div>
        <div>
          <h1>FiveAir1337Life-Time</h1>
          <span>–†–∞–±–æ—Ç–∞ ‚Ä¢ –î–µ–Ω—å–≥–∏ ‚Ä¢ –ù–∞–≤—ã–∫–∏ ‚Ä¢ –ë–∏–∑–Ω–µ—Å</span>
        </div>
      </div>

      <nav>
        <a class="navbtn" href="#guides">üìö –ì–∞–π–¥—ã</a>
        <a class="navbtn" href="#tools">üß∞ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a>
        <a class="navbtn" href="#notes">üìù –ó–∞–º–µ—Ç–∫–∏</a>
        <a class="navbtn" href="#checklist">‚úÖ –î–µ–Ω—å</a>
      </nav>
    </div>
  </div>

  <div class="wrap">
    <section class="hero">
      <div class="hero-grid">
        <div class="card">
          <h2 class="hero-title">–†–µ–∞–ª—å–Ω–∞—è –∂–∏–∑–Ω—å ‚Äî –±–µ–∑ –≤–æ–¥—ã.</h2>
          <p class="hero-sub">
            –ó–¥–µ—Å—å –∫–æ—Ä–æ—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É: –∫–∞–∫ –Ω–∞–π—Ç–∏ —Ä–∞–±–æ—Ç—É, –ø–æ–¥–Ω—è—Ç—å –¥–æ—Ö–æ–¥, –ø—Ä–æ–∫–∞—á–∞—Ç—å –Ω–∞–≤—ã–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏ –±–∏–∑–Ω–µ—Å–∞.
            –í—Å—ë, —á—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è.
          </p>

          <div class="chips">
            <div class="chip"><b>1%</b> –≤ –¥–µ–Ω—å</div>
            <div class="chip">—Ñ–æ–∫—É—Å –Ω–∞ <b>–¥–µ–π—Å—Ç–≤–∏—è—Ö</b></div>
            <div class="chip">–±–µ–∑ <b>—Å–∫–∞–∑–æ–∫</b></div>
          </div>

          <div class="actions">
            <button class="btn btn-primary" id="focusBtn">üåô –§–æ–∫—É—Å-—Ä–µ–∂–∏–º</button>
            <button class="btn btn-ghost" id="resetBtn">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
          </div>

          <div class="kpi" id="kpi">
            <div class="box">
              <div class="small">–ó–∞–º–µ—Ç–æ–∫</div>
              <div class="n" id="kpiNotes">0</div>
            </div>
            <div class="box">
              <div class="small">–ó–∞–¥–∞—á –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</div>
              <div class="n" id="kpiTasks">0</div>
            </div>
            <div class="box">
              <div class="small">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
              <div class="n" id="kpiDone">0</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="section-title">
            <span>‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</span>
            <span class="tag"><span class="dot"></span> –°–µ–≥–æ–¥–Ω—è</span>
          </div>
          <p class="muted" style="margin-top:0">
            –°–¥–µ–ª–∞–π 3 —à–∞–≥–∞: –≤—ã–±–µ—Ä–∏ —Ü–µ–ª—å ‚Üí –ø–æ—Å—Ç–∞–≤—å 3 –∑–∞–¥–∞—á–∏ ‚Üí –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π –∏—Ç–æ–≥.
          </p>
          <div class="sep"></div>

          <label class="small">–¶–µ–ª—å –Ω–∞ –Ω–µ–¥–µ–ª—é</label>
          <input class="input" id="weeklyGoal" placeholder="–ù–∞–ø—Ä: –Ω–∞–π—Ç–∏ —Ä–∞–±–æ—Ç—É / –ø–æ–¥–Ω—è—Ç—å –¥–æ—Ö–æ–¥ / –∑–∞–ø—É—Å—Ç–∏—Ç—å —É—Å–ª—É–≥—É" />

          <div style="height:10px"></div>

          <label class="small">–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?</label>
          <input class="input" id="whyGoal" placeholder="–ù–∞–ø—Ä: —Ö–æ—á—É –≤—ã–π—Ç–∏ –Ω–∞ 50–∫ / –ø–æ–º–æ—á—å —Å–µ–º—å–µ / –∫—É–ø–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É" />

          <div style="height:12px"></div>
          <button class="btn btn-primary" id="saveGoalBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

          <p class="muted" id="goalSaved" style="margin:10px 0 0"></p>
        </div>
      </div>
    </section>

    <section id="guides" class="grid">
      <div class="card">
        <div class="section-title">
          <span>üìö –ì–∞–π–¥—ã</span>
          <span class="muted">–ø–æ–∏—Å–∫ –ø–æ —Ç–µ–º–∞–º</span>
        </div>

        <input class="input" id="searchGuides" placeholder="–ü–æ–∏—Å–∫: —Ä–µ–∑—é–º–µ, —Å–æ–±–µ—Å, –±—é–¥–∂–µ—Ç, —Ñ—Ä–∏–ª–∞–Ω—Å..." />

        <div style="height:10px"></div>

        <ul class="list" id="guidesList">
          <li class="item" data-tags="—Ä–∞–±–æ—Ç–∞ —Ä–µ–∑—é–º–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ">
            <div>
              <b>–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∑—é–º–µ –±–µ–∑ –≤–æ–¥—ã</b>
              <div class="muted">1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞, —Ü–∏—Ñ—Ä—ã, –Ω–∞–≤—ã–∫–∏, –æ–ø—ã—Ç.</div>
              <div style="height:8px"></div>
              <span class="tag"><span class="dot"></span> –†–∞–±–æ—Ç–∞</span>
            </div>
          </li>
          <li class="item" data-tags="—Ä–∞–±–æ—Ç–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å—ã">
            <div>
              <b>10 –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–æ–±–µ—Å–µ –∏ –∫–∞–∫ –æ—Ç–≤–µ—á–∞—Ç—å</b>
              <div class="muted">–ì–æ—Ç–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤, –±–µ–∑ –ø–∞–Ω–∏–∫–∏.</div>
              <div style="height:8px"></div>
              <span class="tag"><span class="dot"></span> –†–∞–±–æ—Ç–∞</span>
            </div>
          </li>
          <li class="item" data-tags="–¥–µ–Ω—å–≥–∏ –±—é–¥–∂–µ—Ç —É—á–µ—Ç">
            <div>
              <b>–ë—é–¥–∂–µ—Ç: —Å—Ö–µ–º–∞ 50/30/20 (–ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏)</b>
              <div class="muted">–ö–∞–∫ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –∂–∏—Ç—å –≤ –Ω–æ–ª—å –∏ –Ω–∞—á–∞—Ç—å –∫–æ–ø–∏—Ç—å.</div>
              <div style="height:8px"></div>
              <span class="tag"><span class="dot"></span> –î–µ–Ω—å–≥–∏</span>
            </div>
          </li>
          <li class="item" data-tags="–±–∏–∑–Ω–µ—Å —É—Å–ª—É–≥–∏ —Å—Ç–∞—Ä—Ç">
            <div>
              <b>–ú–∏–∫—Ä–æ–±–∏–∑–Ω–µ—Å: —É—Å–ª—É–≥–∞ –∑–∞ 0 ‚ÇΩ</b>
              <div class="muted">–ß—Ç–æ –ø—Ä–æ–¥–∞—Ç—å –ø–µ—Ä–≤—ã–º –∏ –≥–¥–µ –∏—Å–∫–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤.</div>
              <div style="height:8px"></div>
              <span class="tag"><span class="dot"></span> –ë–∏–∑–Ω–µ—Å</span>
            </div>
          </li>
          <li class="item" data-tags="–Ω–∞–≤—ã–∫–∏ –æ–±—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ">
            <div>
              <b>–ù–∞–≤—ã–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–∞—é—Ç –¥–µ–Ω—å–≥–∏</b>
              <div class="muted">–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è, –ø—Ä–æ–¥–∞–∂–∏, –¥–∏–∑–∞–π–Ω, –º–æ–Ω—Ç–∞–∂, –∫–æ–¥ ‚Äî –∫–∞–∫ –≤—ã–±—Ä–∞—Ç—å.</div>
              <div style="height:8px"></div>
              <span class="tag"><span class="dot"></span> –ù–∞–≤—ã–∫–∏</span>
            </div>
          </li>
        </ul>

        <p class="muted" id="noGuides" style="display:none;margin-top:10px">
          –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üòÖ –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–µ —Å–ª–æ–≤–æ.
        </p>
      </div>

      <div id="tools" class="card">
        <div class="section-title">
          <span>üß∞ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</span>
          <span class="muted">–±—ã—Å—Ç—Ä–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å</span>
        </div>

        <div class="row">
          <div>
            <label class="small">–ß–∞—Å–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (‚ÇΩ)</label>
            <input class="input" id="rate" type="number" placeholder="–ù–∞–ø—Ä: 250" />
          </div>
          <div>
            <label class="small">–ß–∞—Å–æ–≤</label>
            <input class="input" id="hours" type="number" placeholder="–ù–∞–ø—Ä: 6" />
          </div>
        </div>

        <div style="height:10px"></div>

        <div class="row">
          <div>
            <label class="small">–î–Ω–µ–π</label>
            <input class="input" id="days" type="number" placeholder="–ù–∞–ø—Ä: 20" />
          </div>
          <div>
            <label class="small">–ò—Ç–æ–≥ (‚ÇΩ)</label>
            <input class="input" id="total" type="text" placeholder="0" disabled />
          </div>
        </div>

        <div style="height:12px"></div>
        <div class="row">
          <button class="btn btn-primary" id="calcBtn">üßÆ –ü–æ—Å—á–∏—Ç–∞—Ç—å</button>
          <button class="btn btn-ghost" id="saveCalcBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—á—ë—Ç</button>
        </div>

        <p class="muted" id="calcSaved" style="margin:10px 0 0"></p>

        <div class="sep"></div>

        <div class="section-title" style="margin:0 0 8px">
          <span>üìå –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞—Å—á—ë—Ç</span>
        </div>
        <div class="muted" id="lastCalc">–ü–æ–∫–∞ –ø—É—Å—Ç–æ.</div>
      </div>
    </section>

    <section class="grid" style="margin-top:14px">
      <div id="notes" class="card">
        <div class="section-title">
          <span>üìù –ó–∞–º–µ—Ç–∫–∏</span>
          <span class="muted">—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è</span>
        </div>

        <textarea id="noteText" placeholder="–ó–∞–ø–∏—Å—ã–≤–∞–π –º—ã—Å–ª–∏: —á—Ç–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ —É–ª—É—á—à–∏—Ç—å, —á—Ç–æ –º–µ—à–∞–µ—Ç..."></textarea>
        <div style="height:10px"></div>
        <button class="btn btn-primary" id="addNoteBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>

        <div class="sep"></div>
        <ul class="list" id="notesList"></ul>
        <p class="muted" id="noNotes">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–º–µ—Ç–æ–∫. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é ‚úçÔ∏è</p>
      </div>

      <div id="checklist" class="card">
        <div class="section-title">
          <span>‚úÖ –ü–ª–∞–Ω –Ω–∞ –¥–µ–Ω—å</span>
          <span class="muted">3 –¥–µ–ª–∞ ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ</span>
        </div>

        <div class="row">
          <input class="input" id="taskText" placeholder="–î–æ–±–∞–≤—å –∑–∞–¥–∞—á—É (–ø—Ä–∏–º–µ—Ä: –æ—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ 10 –≤–∞–∫–∞–Ω—Å–∏–π)" />
          <button class="btn btn-primary" id="addTaskBtn">‚ûï</button>
        </div>

        <div class="sep"></div>

        <ul class="list" id="tasksList"></ul>
        <p class="muted" id="noTasks">–ü–æ–∫–∞ –∑–∞–¥–∞—á –Ω–µ—Ç. –î–æ–±–∞–≤—å 1‚Äì3 –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è ‚úÖ</p>
      </div>
    </section>

    <footer>
      ¬© FiveAir1337Life-Time ‚Ä¢ –°–¥–µ–ª–∞–Ω–æ –Ω–∞ GitHub Pages ‚Ä¢ <span class="ok">–±–µ—Å–ø–ª–∞—Ç–Ω–æ</span> ‚úÖ
    </footer>
  </div>

  <script>
    // ===== helpers =====
    const $ = (id) => document.getElementById(id);
    const store = {
      get(key, fallback){
        try{
          const v = localStorage.getItem(key);
          return v ? JSON.parse(v) : fallback;
        }catch(e){ return fallback; }
      },
      set(key, val){
        localStorage.setItem(key, JSON.stringify(val));
      }
    };

    // ===== focus mode =====
    const focusKey = "fa_focus";
    function applyFocus(on){
      if(on){
        document.body.style.background = "#000";
        store.set(focusKey, true);
      } else {
        document.body.style.background = "";
        store.set(focusKey, false);
      }
    }
    applyFocus(!!store.get(focusKey, false));
    $("focusBtn").onclick = () => applyFocus(!store.get(focusKey, false));

    // ===== goal =====
    const goalKey = "fa_goal";
    function loadGoal(){
      const g = store.get(goalKey, {weekly:"", why:""});
      $("weeklyGoal").value = g.weekly || "";
      $("whyGoal").value = g.why || "";
      $("goalSaved").textContent = g.weekly ? "‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ" : "";
    }
    $("saveGoalBtn").onclick = () => {
      store.set(goalKey, { weekly: $("weeklyGoal").value.trim(), why: $("whyGoal").value.trim() });
      $("goalSaved").textContent = "‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ";
      setTimeout(()=> $("goalSaved").textContent = "", 1500);
    };
    loadGoal();

    // ===== guides search =====
    $("searchGuides").addEventListener("input", () => {
      const q = $("searchGuides").value.trim().toLowerCase();
      const items = Array.from($("guidesList").querySelectorAll(".item"));
      let shown = 0;

      items.forEach(li => {
        const tags = (li.getAttribute("data-tags") || "").toLowerCase();
        const text = li.innerText.toLowerCase();
        const ok = !q || tags.includes(q) || text.includes(q);
        li.style.display = ok ? "flex" : "none";
        if(ok) shown++;
      });

      $("noGuides").style.display = shown ? "none" : "block";
    });

    // ===== calculator =====
    const calcKey = "fa_calc";
    function formatMoney(n){
      const num = Number(n || 0);
      return num.toLocaleString("ru-RU");
    }
    function calc(){
      const rate = Number($("rate").value || 0);
      const hours = Number($("hours").value || 0);
      const days = Number($("days").value || 0);
      const total = rate * hours * days;
      $("total").value = formatMoney(total);
      return { rate, hours, days, total };
    }
    $("calcBtn").onclick = calc;

    function loadLastCalc(){
      const c = store.get(calcKey, null);
      if(!c){ $("lastCalc").textContent = "–ü–æ–∫–∞ –ø—É—Å—Ç–æ."; return; }
      $("lastCalc").textContent = `${c.rate} ‚ÇΩ/—á–∞—Å ‚Ä¢ ${c.hours} —á/–¥–µ–Ω—å ‚Ä¢ ${c.days} –¥–Ω–µ–π ‚Üí –ò—Ç–æ–≥–æ: ${formatMoney(c.total)} ‚ÇΩ`;
    }
    $("saveCalcBtn").onclick = () => {
      const c = calc();
      store.set(calcKey, c);
      loadLastCalc();
      $("calcSaved").textContent = "‚úÖ –†–∞—Å—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω";
      setTimeout(()=> $("calcSaved").textContent = "", 1500);
    };
    loadLastCalc();

    // ===== notes =====
    const notesKey = "fa_notes";
    function renderNotes(){
      const notes = store.get(notesKey, []);
      const ul = $("notesList");
      ul.innerHTML = "";
      $("noNotes").style.display = notes.length ? "none" : "block";

      notes.forEach((n, idx) => {
        const li = document.createElement("li");
        li.className = "item";
        li.innerHTML = `
          <div style="width:100%">
            <b>${escapeHtml(n.title)}</b>
            <div class="muted">${escapeHtml(n.text)}</div>
            <div style="height:10px"></div>
            <button class="btn btn-ghost" data-del-note="${idx}">üóë –£–¥–∞–ª–∏—Ç—å</button>
          </div>
        `;
        ul.appendChild(li);
      });

      ul.querySelectorAll("[data-del-note]").forEach(btn => {
        btn.onclick = () => {
          const i = Number(btn.getAttribute("data-del-note"));
          const arr = store.get(notesKey, []);
          arr.splice(i, 1);
          store.set(notesKey, arr);
          renderNotes();
          renderKPI();
        };
      });
    }
    function escapeHtml(str){
      return String(str || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }
    $("addNoteBtn").onclick = () => {
      const text = $("noteText").value.trim();
      if(!text) return;

      const title = text.length > 38 ? text.slice(0, 38) + "‚Ä¶" : text;
      const notes = store.get(notesKey, []);
      notes.unshift({ title, text, at: Date.now() });
      store.set(notesKey, notes);
      $("noteText").value = "";
      renderNotes();
      renderKPI();
    };
    renderNotes();

    // ===== tasks =====
    const tasksKey = "fa_tasks";
    function renderTasks(){
      const tasks = store.get(tasksKey, []);
      const ul = $("tasksList");
      ul.innerHTML = "";
      $("noTasks").style.display = tasks.length ? "none" : "block";

      tasks.forEach((t, idx) => {
        const li = document.createElement("li");
        li.className = "item";
        li.innerHTML = `
          <input type="checkbox" ${t.done ? "checked" : ""} data-tk="${idx}" style="margin-top:2px;transform:scale(1.1)">
          <div style="width:100%">
            <b>${escapeHtml(t.text)}</b>
            <div class="muted">${t.done ? "<span class='ok'>–°–¥–µ–ª–∞–Ω–æ ‚úÖ</span>" : "–í –ø—Ä–æ—Ü–µ—Å—Å–µ‚Ä¶"}</div>
            <div style="height:10px"></div>
            <button class="btn btn-ghost" data-del-task="${idx}">üóë –£–¥–∞–ª–∏—Ç—å</button>
          </div>
        `;
        ul.appendChild(li);
      });

      ul.querySelectorAll("[data-tk]").forEach(ch => {
        ch.onchange = () => {
          const i = Number(ch.getAttribute("data-tk"));
          const arr = store.get(tasksKey, []);
          arr[i].done = ch.checked;
          store.set(tasksKey, arr);
          renderTasks();
          renderKPI();
        };
      });

      ul.querySelectorAll("[data-del-task]").forEach(btn => {
        btn.onclick = () => {
          const i = Number(btn.getAttribute("data-del-task"));
          const arr = store.get(tasksKey, []);
          arr.splice(i, 1);
          store.set(tasksKey, arr);
          renderTasks();
          renderKPI();
        };
      });
    }

    $("addTaskBtn").onclick = () => {
      const text = $("taskText").value.trim();
      if(!text) return;
      const tasks = store.get(tasksKey, []);
      tasks.push({ text, done:false, at: Date.now() });
      store.set(tasksKey, tasks);
      $("taskText").value = "";
      renderTasks();
      renderKPI();
    };
    renderTasks();

    // ===== KPI =====
    function renderKPI(){
      const notes = store.get(notesKey, []);
      const tasks = store.get(tasksKey, []);
      const done = tasks.filter(t=>t.done).length;

      $("kpiNotes").textContent = notes.length;
      $("kpiTasks").textContent = tasks.length;
      $("kpiDone").textContent = done;
    }
    renderKPI();

    // ===== reset =====
    $("resetBtn").onclick = () => {
      const ok = confirm("–¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –∑–∞–º–µ—Ç–∫–∏/–∑–∞–¥–∞—á–∏/—Ü–µ–ª–∏? –≠—Ç–æ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.");
      if(!ok) return;
      localStorage.removeItem(notesKey);
      localStorage.removeItem(tasksKey);
      localStorage.removeItem(goalKey);
      localStorage.removeItem(calcKey);
      renderNotes();
      renderTasks();
      loadGoal();
      loadLastCalc();
      renderKPI();
      alert("–ì–æ—Ç–æ–≤–æ ‚úÖ");
    };
  </script>
</body>
</html>
